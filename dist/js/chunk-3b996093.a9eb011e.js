(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3b996093"],{"3f18":function(t,o,e){t.exports=e.p+"img/icon-position.cf4fae51.svg"},"4bb4":function(t,o,e){"use strict";e.r(o);var a=e("7a23"),i=e("3f18"),n=e.n(i),c=Object(a["e"])("div",{id:"mapid",class:"mapid"},null,-1),s=Object(a["e"])("img",{src:n.a,alt:"position icon"},null,-1),r=[s];function d(t,o,e,i,n,s){var d=Object(a["w"])("Search");return Object(a["r"])(),Object(a["d"])(a["a"],null,[c,Object(a["h"])(d),Object(a["e"])("button",{onClick:o[0]||(o[0]=function(){return s.geoBtn&&s.geoBtn.apply(s,arguments)}),type:"button",class:"pos-btn btn btn-dark rounded-circle"},r)],64)}e("d81d"),e("99af"),e("d3b7"),e("159b");var l=e("e11e"),p=e.n(l),u=e("c93e"),h=e.n(u),b={class:"search-box rounded-3 bg-dark position-relative"},m=Object(a["e"])("div",{class:"d-flex"},[Object(a["e"])("h5",{class:"me-3 text-secondary"},"下班後來兜風，找單車站 . . ."),Object(a["e"])("img",{alt:"bike",src:h.a})],-1),f=Object(a["e"])("div",{class:"d-flex my-3"},[Object(a["e"])("input",{type:"text",class:"form-control me-2 shadow-sm",placeholder:"請輸入單車站","aria-label":"bike station","aria-describedby":"search"}),Object(a["e"])("button",{class:"btn btn-primary shadow",type:"button",id:"search"},[Object(a["e"])("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-search",viewBox:"0 0 16 16"},[Object(a["e"])("path",{d:"M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"})])])],-1),g=Object(a["e"])("div",null,[Object(a["e"])("button",{class:"tag rounded-pill btn btn-outline-info"},"市政府")],-1),w=[m,f,g];function v(t,o,e,i,n,c){return Object(a["r"])(),Object(a["d"])("div",b,w)}var y={data:function(){return{}}},k=(e("d307"),e("d959")),S=e.n(k);const O=S()(y,[["render",v]]);var j=O,B=e("6c2d"),x={components:{Search:j},data:function(){return{mymap:null,nowLocation:{latitude:25.047675,longitude:121.517055},apiStation:[],apiBike:[]}},methods:{geoBtn:function(){var t=this;navigator.geolocation?navigator.geolocation.getCurrentPosition((function(o){console.log(o.coords.latitude),console.log(o.coords.longitude),t.nowLocation.latitude=o.coords.latitude,t.nowLocation.longitude=o.coords.longitude}),(function(t){console.log(t.message)})):console.log("Your browser does not support geolocation API")},getMap:function(){this.mymap=p.a.map("mapid").setView([this.nowLocation.latitude,this.nowLocation.longitude],15),p.a.tileLayer("https://api.mapbox.com/styles/v1/{username}/{style_id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,username:"unayo",style_id:"ckw6oruov0sl614pinxf6eb44",tileSize:512,zoomOffset:-1,accessToken:"pk.eyJ1IjoidW5heW8iLCJhIjoiY2t1d2EwNzZpMGh2aDJ3cmYwdWJnb2hudyJ9.XcnKuVJN2Q50urzdA594WQ"}).addTo(this.mymap),p.a.control.zoom({position:"bottomright"}).addTo(this.mymap)},getApiStation:function(){var t=this,o="https://ptx.transportdata.tw/MOTC/v2/Bike/Station/NearBy?$top=30&$spatialFilter=nearby(".concat(this.nowLocation.latitude,", ").concat(this.nowLocation.longitude,", 1000)&$format=JSON");this.$http.get(o,{headers:this.apiID()}).then((function(o){t.apiStation=o.data})).catch((function(t){console.log("error",t.response)}))},getApiBike:function(){var t=this;this.getApiStation();var o="https://ptx.transportdata.tw/MOTC/v2/Bike/Availability/NearBy?$top=30&$spatialFilter=nearby(".concat(this.nowLocation.latitude,", ").concat(this.nowLocation.longitude,", 1000)&$format=JSON");this.$http.get(o,{headers:this.apiID()}).then((function(o){var e=o.data;e.forEach((function(o){t.apiStation.forEach((function(e){o.StationUID===e.StationUID&&(o.StationName=e.StationName,o.StationPosition=e.StationPosition,o.StationAddress=e.StationAddress,o.StopDescription=e.StopDescription,o.BikesCapacity=e.BikesCapacity,t.apiBike.push(o))}))})),console.log("總和 api 資料",t.apiBike),t.setMarker()}))},apiID:function(){var t="d270b525f2114a95895b7670090cb92c",o="Pwts_rFo3XHtvuvjDziNlG6fqvM",e=(new Date).toGMTString(),a=new B["a"]("SHA-1","TEXT");a.setHMACKey(o,"TEXT"),a.update("x-date: "+e);var i=a.getHMAC("B64"),n='hmac username="'.concat(t,'", algorithm="hmac-sha1", headers="x-date", signature="').concat(i,'"');return{Authorization:n,"X-Date":e}},setMarker:function(){var t=this;this.apiBike.forEach((function(o){var e=new p.a.DivIcon({html:'<span class="number">'.concat(o.AvailableRentBikes,"</span>"),className:"leafletIcon",iconSize:[36,44]});p.a.marker([o.StationPosition.PositionLat,o.StationPosition.PositionLon],{icon:e}).addTo(t.mymap)}))}},watch:{nowLocation:{handler:function(t){this.mymap.setView([t.latitude,t.longitude],17),this.getApiBike(),console.log("new",t)},deep:!0}},mounted:function(){this.getMap(),this.geoBtn(),this.getApiBike()}};e("5511");const M=S()(x,[["render",d]]);o["default"]=M},5511:function(t,o,e){"use strict";e("df5e")},d307:function(t,o,e){"use strict";e("f2cc")},df5e:function(t,o,e){},f2cc:function(t,o,e){}}]);
//# sourceMappingURL=chunk-3b996093.a9eb011e.js.map